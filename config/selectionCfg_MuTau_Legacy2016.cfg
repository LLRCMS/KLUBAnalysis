
# the definition of composed selections. Can contain as well TCut style selections, e.g.:
# resolved = baseline, btagMM, massCut
# resolvedHighPt = baseline, btagMM, massCut, dau1_pt > 150
# use comma separated lists
[selections]

### some selections with tes up/down
### note: jets are selected at skim level to have pt > 20
### so I am raising the pt value to 25 just to test the change in the acceptance
#nosel = pairType > -999

baseline_nominal     = pairType == 0 && dau1_pt > 23 && abs(dau1_eta) < 2.1 && dau2_pt > 20         && abs(dau2_eta) < 2.3 && nleps == 0 && bjet1_pt_raw > 25         && bjet2_pt_raw > 25
baseline_tesUp       = pairType == 0 && dau1_pt > 23 && abs(dau1_eta) < 2.1 && dau2_pt_tauup > 20   && abs(dau2_eta) < 2.3 && nleps == 0 && bjet1_pt_raw > 25         && bjet2_pt_raw > 25
baseline_tesDown     = pairType == 0 && dau1_pt > 23 && abs(dau1_eta) < 2.1 && dau2_pt_taudown > 20 && abs(dau2_eta) < 2.3 && nleps == 0 && bjet1_pt_raw > 25         && bjet2_pt_raw > 25
baseline_jesUp       = pairType == 0 && dau1_pt > 23 && abs(dau1_eta) < 2.1 && dau2_pt > 20         && abs(dau2_eta) < 2.3 && nleps == 0 && bjet1_pt_raw_jetup > 25   && bjet2_pt_raw_jetup > 25
baseline_jesDown     = pairType == 0 && dau1_pt > 23 && abs(dau1_eta) < 2.1 && dau2_pt > 20         && abs(dau2_eta) < 2.3 && nleps == 0 && bjet1_pt_raw_jetdown > 25 && bjet2_pt_raw_jetdown > 25
ellypsMassCut_tesUp    = ((tauH_SVFIT_mass_up-116.)*(tauH_SVFIT_mass_up-116.))/(35.*35.) + ((bH_mass_raw-111.)*(bH_mass_raw-111.))/(45.*45.) <  1.0
ellypsMassCut_tesDown  = ((tauH_SVFIT_mass_down-116.)*(tauH_SVFIT_mass_down-116.))/(35.*35.) + ((bH_mass_raw-111.)*(bH_mass_raw-111.))/(45.*45.) <  1.0
ellypsMassCut_jesUp    = ((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.))/(35.*35.) + ((bH_mass_raw_jetup-111.)*(bH_mass_raw_jetup-111.))/(45.*45.) <  1.0
ellypsMassCut_jesDown  = ((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.))/(35.*35.) + ((bH_mass_raw_jetdown-111.)*(bH_mass_raw_jetdown-111.))/(45.*45.) <  1.0

s1b1jresolvedMcutlmr70_nominal = baseline_nominal , btagM,  isBoosted != 1 , ellypsMassCut, lmrBDTCut70rej
s2b0jresolvedMcutlmr70_nominal = baseline_nominal , btagMM, isBoosted != 1 , ellypsMassCut, lmrBDTCut70rej
s1b1jresolvedMcutlmr90_nominal = baseline_nominal , btagM,  isBoosted != 1 , ellypsMassCut, lmrBDTCut90rej
s2b0jresolvedMcutlmr90_nominal = baseline_nominal , btagMM, isBoosted != 1 , ellypsMassCut, lmrBDTCut90rej
s1b1jresolvedMcuthmr90_nominal = baseline_nominal , btagM,  isBoosted != 1 , ellypsMassCut, hmrBDTCut90rej
s2b0jresolvedMcuthmr90_nominal = baseline_nominal , btagMM, isBoosted != 1 , ellypsMassCut, hmrBDTCut90rej
sboostedLLMcut_nominal         = baseline_nominal , btagLL, isBoosted == 1 , boostMassCut

s1b1jresolvedMcutlmr70_tesUp = baseline_tesUp , btagM,  isBoosted != 1 , ellypsMassCut_tesUp, lmrBDTCut70rej
s2b0jresolvedMcutlmr70_tesUp = baseline_tesUp , btagMM, isBoosted != 1 , ellypsMassCut_tesUp, lmrBDTCut70rej
s1b1jresolvedMcutlmr90_tesUp = baseline_tesUp , btagM,  isBoosted != 1 , ellypsMassCut_tesUp, lmrBDTCut90rej
s2b0jresolvedMcutlmr90_tesUp = baseline_tesUp , btagMM, isBoosted != 1 , ellypsMassCut_tesUp, lmrBDTCut90rej
s1b1jresolvedMcuthmr90_tesUp = baseline_tesUp , btagM,  isBoosted != 1 , ellypsMassCut_tesUp, hmrBDTCut90rej
s2b0jresolvedMcuthmr90_tesUp = baseline_tesUp , btagMM, isBoosted != 1 , ellypsMassCut_tesUp, hmrBDTCut90rej
sboostedLLMcut_tesUp         = baseline_tesUp , btagLL, isBoosted == 1 , boostMassCut

s1b1jresolvedMcutlmr70_tesDown = baseline_tesDown , btagM,  isBoosted != 1 , ellypsMassCut_tesDown, lmrBDTCut70rej
s2b0jresolvedMcutlmr70_tesDown = baseline_tesDown , btagMM, isBoosted != 1 , ellypsMassCut_tesDown, lmrBDTCut70rej
s1b1jresolvedMcutlmr90_tesDown = baseline_tesDown , btagM,  isBoosted != 1 , ellypsMassCut_tesDown, lmrBDTCut90rej
s2b0jresolvedMcutlmr90_tesDown = baseline_tesDown , btagMM, isBoosted != 1 , ellypsMassCut_tesDown, lmrBDTCut90rej
s1b1jresolvedMcuthmr90_tesDown = baseline_tesDown , btagM,  isBoosted != 1 , ellypsMassCut_tesDown, hmrBDTCut90rej
s2b0jresolvedMcuthmr90_tesDown = baseline_tesDown , btagMM, isBoosted != 1 , ellypsMassCut_tesDown, hmrBDTCut90rej
sboostedLLMcut_tesDown         = baseline_tesDown , btagLL, isBoosted == 1 , boostMassCut

s1b1jresolvedMcutlmr70_jesUp = baseline_jesUp , btagM,  isBoosted != 1 , ellypsMassCut_jesUp, lmrBDTCut70rej
s2b0jresolvedMcutlmr70_jesUp = baseline_jesUp , btagMM, isBoosted != 1 , ellypsMassCut_jesUp, lmrBDTCut70rej
s1b1jresolvedMcutlmr90_jesUp = baseline_jesUp , btagM,  isBoosted != 1 , ellypsMassCut_jesUp, lmrBDTCut90rej
s2b0jresolvedMcutlmr90_jesUp = baseline_jesUp , btagMM, isBoosted != 1 , ellypsMassCut_jesUp, lmrBDTCut90rej
s1b1jresolvedMcuthmr90_jesUp = baseline_jesUp , btagM,  isBoosted != 1 , ellypsMassCut_jesUp, hmrBDTCut90rej
s2b0jresolvedMcuthmr90_jesUp = baseline_jesUp , btagMM, isBoosted != 1 , ellypsMassCut_jesUp, hmrBDTCut90rej
sboostedLLMcut_jesUp         = baseline_jesUp , btagLL, isBoosted == 1 , boostMassCut


s1b1jresolvedMcutlmr70_jesDown = baseline_jesDown , btagM,  isBoosted != 1 , ellypsMassCut_jesDown, lmrBDTCut70rej
s2b0jresolvedMcutlmr70_jesDown = baseline_jesDown , btagMM, isBoosted != 1 , ellypsMassCut_jesDown, lmrBDTCut70rej
s1b1jresolvedMcutlmr90_jesDown = baseline_jesDown , btagM,  isBoosted != 1 , ellypsMassCut_jesDown, lmrBDTCut90rej
s2b0jresolvedMcutlmr90_jesDown = baseline_jesDown , btagMM, isBoosted != 1 , ellypsMassCut_jesDown, lmrBDTCut90rej
s1b1jresolvedMcuthmr90_jesDown = baseline_jesDown , btagM,  isBoosted != 1 , ellypsMassCut_jesDown, hmrBDTCut90rej
s2b0jresolvedMcuthmr90_jesDown = baseline_jesDown , btagMM, isBoosted != 1 , ellypsMassCut_jesDown, hmrBDTCut90rej
sboostedLLMcut_jesDown         = baseline_jesDown , btagLL, isBoosted == 1 , boostMassCut

###############################################################

# pT and eta cuts are already applied at trig match level, so they are not needed here
# dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt > 20 && abs (dau2_eta) < 2.3
baseline       = pairType == 0 && nleps == 0 && nbjetscand > 1
baselineHTT    = pairType == 0 && nleps == 0
baselineHTT_S  = baselineHTT
baselineHTT_C  = baselineHTT
baselineVBF    = baseline, isVBF == 1
baselineNoVBF  = baseline, isVBF == 0
baseline55     = baseline, tauH_SVFIT_mass > 50

baselineVBFloose  = baseline, isVBF == 1 && VBFjj_mass > 500 && VBFjj_deltaEta > 3

# 2016 deepFlavor
# btag requirements - DeepFlavor WPs={0.0614, 0.3093, 0.7221}; // L,M,T -- Legacy 2016 DeepFlavor
btagL        = (bjet1_bID_deepFlavor > 0.0614 && bjet2_bID_deepFlavor < 0.0614) || (bjet1_bID_deepFlavor < 0.0614 && bjet2_bID_deepFlavor > 0.0614) #only 1 jet with loose btag working point
btagM        = (bjet1_bID_deepFlavor > 0.3093 && bjet2_bID_deepFlavor < 0.3093) || (bjet1_bID_deepFlavor < 0.3093 && bjet2_bID_deepFlavor > 0.3093) #only 1 jet with medium btag working point
btagMfirst   = (bjet1_bID_deepFlavor > 0.3093) || (bjet2_bID_deepFlavor > 0.3093)                                                                   #at least 1 jet with medium btag working point
btagLL       = bjet1_bID_deepFlavor > 0.0614 && bjet2_bID_deepFlavor > 0.0614 #both jets with loose btag working point
btagMM       = bjet1_bID_deepFlavor > 0.3093 && bjet2_bID_deepFlavor > 0.3093 #both jets with medium btag working point
nobtagMM     = bjet1_bID_deepFlavor < 0.3093 && bjet2_bID_deepFlavor < 0.3093 #both jets NOT btagged (medium working point)
nobtagL      = bjet1_bID_deepFlavor < 0.0614 && bjet2_bID_deepFlavor < 0.0614


massCut      = bH_mass_raw > 80 && bH_mass_raw < 160 && tauH_SVFIT_mass > 80 && tauH_SVFIT_mass < 160
massCutCent  = tauH_SVFIT_mass > 79.5 && tauH_SVFIT_mass < 152.5 && bH_mass_raw > 74.5 && bH_mass_raw < 147.5
boostMassCut = tauH_SVFIT_mass > 79.5 && tauH_SVFIT_mass < 152.5 && fatjet_softdropMass > 90 && fatjet_softdropMass < 160
circMassCut    = TMath::Sqrt((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.) + (bH_mass_raw-111.)*(bH_mass_raw-111.)) <  40.0
ellypsMassCut  = ((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.))/(35.*35.) + ((bH_mass_raw-111.)*(bH_mass_raw-111.))/(45.*45.) <  1.0
ringCut = TMath::Sqrt((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.) + (bH_mass_raw-111.)*(bH_mass_raw-111.)) >  40.0 && TMath::Sqrt((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.) + (bH_mass_raw-111.)*(bH_mass_raw-111.)) < 60.0
ringCutLarge = TMath::Sqrt((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.) + (bH_mass_raw-111.)*(bH_mass_raw-111.)) >  40.0 && TMath::Sqrt((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.) + (bH_mass_raw-111.)*(bH_mass_raw-111.)) < 80.0
ringCutVLarge = TMath::Sqrt((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.) + (bH_mass_raw-111.)*(bH_mass_raw-111.)) >  40.0 && TMath::Sqrt((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.) + (bH_mass_raw-111.)*(bH_mass_raw-111.)) < 100.0
massSideband = bH_mass_raw > 156 && bH_mass_raw < 256 && tauH_SVFIT_mass > 151 && tauH_SVFIT_mass <  251
MTcut        = mT1 < 30
MTcutTight   = mT1 < 20
resBDTCut    = BDTResonant > 0.4
nonresBDTCut = LepTauKine > -0.134
minHmass     = tauH_mass>60
METCut       = met_et < 40
invMETCut    = met_et > 40

# updated mass cuts to be used with DNN 2020-07-31 (both ellyptical)
# https://github.com/GilesStrong/cms_runII_dnn_models#mass-cuts
boostMassCut2  = ((tauH_SVFIT_mass-128.)*(tauH_SVFIT_mass-128.))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.)   <  1.0
ellypsMassCut2 = ((tauH_SVFIT_mass-129.)*(tauH_SVFIT_mass-129.))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0


# trigger selections - REMEMBER: also change the trigg/ID SF!!
# bit - path
# 0 - HLT_IsoMu24_v
# 1 - HLT_IsoMu27_v
# 2 - HLT_Ele32_WPTight_Gsf_v
# 3 - HLT_Ele35_WPTight_Gsf_v
# 4 - HLT_DoubleTightChargedIsoPFTau35_Trk1_TightID_eta2p1_Reg_v
# 5 - HLT_DoubleMediumChargedIsoPFTau40_Trk1_TightID_eta2p1_Reg_v
# 6 - HLT_DoubleTightChargedIsoPFTau40_Trk1_eta2p1_Reg_v
# 7 - HLT_IsoMu20_eta2p1_LooseChargedIsoPFTau27_eta2p1_CrossL1_v
# 8 - HLT_Ele24_eta2p1_WPTight_Gsf_LooseChargedIsoPFTau30_eta2p1_CrossL1_v

single = ( (pass_triggerbit >> 0)&1 || (pass_triggerbit >> 1)&1 )
cross  = ( (pass_triggerbit >> 7)&1 )
onlysingle = ( (pass_triggerbit >> 0)&1 || (pass_triggerbit >> 1)&1 ) && !( (pass_triggerbit >> 7)&1 )
onlycross  = ( (pass_triggerbit >> 7)&1 ) && !( (pass_triggerbit >> 0)&1 ) && !( (pass_triggerbit >> 1)&1 )

baselineHTT_single = baselineHTT_S, single
baselineHTT_cross  = baselineHTT_C, single

# ABCD regions used in the analysis - MVA2017v2
#SR           = isOS != 0 && dau1_iso < 0.15 && dau2_MVAisoNew >= 3
#SStight      = isOS == 0 && dau1_iso < 0.15 && dau2_MVAisoNew >= 3
#OSrlx        = isOS != 0 && dau1_iso < 0.15 && dau2_MVAisoNew >= 1
#SSrlx        = isOS == 0 && dau1_iso < 0.15 && dau2_MVAisoNew >= 1
#OSinviso     = isOS != 0 && dau1_iso < 0.15 && dau2_MVAisoNew >= 1 && dau2_MVAisoNew < 3
#SSinviso     = isOS == 0 && dau1_iso < 0.15 && dau2_MVAisoNew >= 1 && dau2_MVAisoNew < 3
#SRforEff      = SR, genDecMode1 == 0
#SRforEffNoSel = pairType > -999

# ABCD regions used in the analysis - DeepTau
SR           = isOS != 0 && dau1_iso < 0.15 && dau2_deepTauVsJet >= 5                            # signal region: opposite sign, isolated taus
SStight      = isOS == 0 && dau1_iso < 0.15 && dau2_deepTauVsJet >= 5			                 # B region
OSrlx        = isOS != 0 && dau1_iso < 0.15 && dau2_deepTauVsJet >= 2
SSrlx        = isOS == 0 && dau1_iso < 0.15 && dau2_deepTauVsJet >= 2			                 # B' region
OSinviso     = isOS != 0 && dau1_iso < 0.15 && dau2_deepTauVsJet >= 2 && dau2_deepTauVsJet < 5   # C region
SSinviso     = isOS == 0 && dau1_iso < 0.15 && dau2_deepTauVsJet >= 2 && dau2_deepTauVsJet < 5   # D region



baselineBstd = baseline, isBoosted == 1

baselineMassCut = baseline, ellypsMassCut

antiB        = baseline , nobtagMM
antiBHTT     = baselineHTT , nobtagMM

s1b1j        = baseline , btagM
s2b0j        = baseline , btagMM
s0b2j        = baseline , nobtagMM

s1b1jresolved = baseline , btagM, isBoosted != 1
s2b0jresolved = baseline , btagMM, isBoosted != 1
sboostedLL    = baseline , btagLL, isBoosted == 1
sboostedMM    = baseline , btagMM, isBoosted == 1


s2b0jresolvedRingCut = baseline , btagMM, isBoosted != 1 , ringCut


s1b1jresolvedMcutBDT = baseline , btagM, isBoosted != 1 , ellypsMassCut, nonresBDTCut
s2b0jresolvedMcutBDT = baseline , btagMM, isBoosted != 1 , ellypsMassCut, nonresBDTCut
sboostedMMMcut       = baseline , btagMM, isBoosted == 1 , boostMassCut


s1b1jMcut    = baseline , btagM , ellypsMassCut
s2b0jMcut    = baseline , btagMM , ellypsMassCut
s1b1jMcutBDT = baseline , btagM , ellypsMassCut, nonresBDTCut
s2b0jMcutBDT = baseline , btagMM , ellypsMassCut, nonresBDTCut


s2b0jMassSideband = baseline , btagMM, massSideband
s2b0jMassSidebandRing = baseline , btagMM, ringCut
s2b0jMassSidebandRingLarge = baseline , btagMM, ringCutLarge
s2b0jMassSidebandRingVLarge = baseline , btagMM, ringCutVLarge


s0b2jMcut              = s0b2j,     ellypsMassCut
s0b2jresolvedMcut      = s0b2jMcut, isBoosted != 1
s0b2jresolvedMcutMtcut = s0b2jresolvedMcut, mT1 < 30

s2b0jresolvedMcutMTCut = s2b0jresolvedMcut, MTcut

# final categories - Run2 Legacy (including VBF category)
s1b1jresolvedMcut = baseline , btagM , isBoosted != 1 , ellypsMassCut2, !(isVBF == 1 && VBFjj_mass > 500 && VBFjj_deltaEta > 3 && bjet1_bID_deepFlavor > 0.3093)
s2b0jresolvedMcut = baseline , btagMM, isBoosted != 1 , ellypsMassCut2, !(isVBF == 1 && VBFjj_mass > 500 && VBFjj_deltaEta > 3 && bjet1_bID_deepFlavor > 0.3093)
sboostedLLMcut    = baseline , btagLL, isBoosted == 1 , boostMassCut2 , !(isVBF == 1 && VBFjj_mass > 500 && VBFjj_deltaEta > 3 && bjet1_bID_deepFlavor > 0.3093)


# VBF category
VBFloose     = baselineVBFloose, btagMfirst
VBFlooseMcut = VBFloose, ellypsMassCut
VBFtight     = baselineVBFtight, btagMfirst

VBF_0_0   = baseline, isVBF == 1, VBFjj_mass > 0 , VBFjj_deltaEta > 0

# VBF "multi-categories"
mpp_ggf_v1    = (mdnn__v1__kl1_c2v1_c31__hh_ggf > mdnn__v1__kl1_c2v1_c31__hh_vbf) && (mdnn__v1__kl1_c2v1_c31__hh_ggf > mdnn__v1__kl1_c2v1_c31__tth)    && (mdnn__v1__kl1_c2v1_c31__hh_ggf > mdnn__v1__kl1_c2v1_c31__tt_lep) && (mdnn__v1__kl1_c2v1_c31__hh_ggf > mdnn__v1__kl1_c2v1_c31__tt_fh)  && (mdnn__v1__kl1_c2v1_c31__hh_ggf > mdnn__v1__kl1_c2v1_c31__dy)
mpp_vbf_v1    = (mdnn__v1__kl1_c2v1_c31__hh_vbf > mdnn__v1__kl1_c2v1_c31__hh_ggf) && (mdnn__v1__kl1_c2v1_c31__hh_vbf > mdnn__v1__kl1_c2v1_c31__tth)    && (mdnn__v1__kl1_c2v1_c31__hh_vbf > mdnn__v1__kl1_c2v1_c31__tt_lep) && (mdnn__v1__kl1_c2v1_c31__hh_vbf > mdnn__v1__kl1_c2v1_c31__tt_fh)  && (mdnn__v1__kl1_c2v1_c31__hh_vbf > mdnn__v1__kl1_c2v1_c31__dy)
mpp_tth_v1    = (mdnn__v1__kl1_c2v1_c31__tth    > mdnn__v1__kl1_c2v1_c31__hh_ggf) && (mdnn__v1__kl1_c2v1_c31__tth    > mdnn__v1__kl1_c2v1_c31__hh_vbf) && (mdnn__v1__kl1_c2v1_c31__tth    > mdnn__v1__kl1_c2v1_c31__tt_lep) && (mdnn__v1__kl1_c2v1_c31__tth    > mdnn__v1__kl1_c2v1_c31__tt_fh)  && (mdnn__v1__kl1_c2v1_c31__tth    > mdnn__v1__kl1_c2v1_c31__dy)
mpp_ttlep_v1  = (mdnn__v1__kl1_c2v1_c31__tt_lep > mdnn__v1__kl1_c2v1_c31__hh_ggf) && (mdnn__v1__kl1_c2v1_c31__tt_lep > mdnn__v1__kl1_c2v1_c31__hh_vbf) && (mdnn__v1__kl1_c2v1_c31__tt_lep > mdnn__v1__kl1_c2v1_c31__tth)    && (mdnn__v1__kl1_c2v1_c31__tt_lep > mdnn__v1__kl1_c2v1_c31__tt_fh)  && (mdnn__v1__kl1_c2v1_c31__tt_lep > mdnn__v1__kl1_c2v1_c31__dy)
mpp_tthad_v1  = (mdnn__v1__kl1_c2v1_c31__tt_fh  > mdnn__v1__kl1_c2v1_c31__hh_ggf) && (mdnn__v1__kl1_c2v1_c31__tt_fh  > mdnn__v1__kl1_c2v1_c31__hh_vbf) && (mdnn__v1__kl1_c2v1_c31__tt_fh  > mdnn__v1__kl1_c2v1_c31__tth)    && (mdnn__v1__kl1_c2v1_c31__tt_fh  > mdnn__v1__kl1_c2v1_c31__tt_lep) && (mdnn__v1__kl1_c2v1_c31__tt_fh  > mdnn__v1__kl1_c2v1_c31__dy)
mpp_dy_v1     = (mdnn__v1__kl1_c2v1_c31__dy     > mdnn__v1__kl1_c2v1_c31__hh_ggf) && (mdnn__v1__kl1_c2v1_c31__dy     > mdnn__v1__kl1_c2v1_c31__hh_vbf) && (mdnn__v1__kl1_c2v1_c31__dy     > mdnn__v1__kl1_c2v1_c31__tth)    && (mdnn__v1__kl1_c2v1_c31__dy     > mdnn__v1__kl1_c2v1_c31__tt_lep) && (mdnn__v1__kl1_c2v1_c31__dy     > mdnn__v1__kl1_c2v1_c31__tt_fh)

mpp_ggf_v2    = (mdnn__v2__kl1_c2v1_c31__hh_ggf > mdnn__v2__kl1_c2v1_c31__hh_vbf) && (mdnn__v2__kl1_c2v1_c31__hh_ggf > mdnn__v2__kl1_c2v1_c31__tth)    && (mdnn__v2__kl1_c2v1_c31__hh_ggf > mdnn__v2__kl1_c2v1_c31__tt_lep) && (mdnn__v2__kl1_c2v1_c31__hh_ggf > mdnn__v2__kl1_c2v1_c31__tt_fh)  && (mdnn__v2__kl1_c2v1_c31__hh_ggf > mdnn__v2__kl1_c2v1_c31__dy)
mpp_vbf_v2    = (mdnn__v2__kl1_c2v1_c31__hh_vbf > mdnn__v2__kl1_c2v1_c31__hh_ggf) && (mdnn__v2__kl1_c2v1_c31__hh_vbf > mdnn__v2__kl1_c2v1_c31__tth)    && (mdnn__v2__kl1_c2v1_c31__hh_vbf > mdnn__v2__kl1_c2v1_c31__tt_lep) && (mdnn__v2__kl1_c2v1_c31__hh_vbf > mdnn__v2__kl1_c2v1_c31__tt_fh)  && (mdnn__v2__kl1_c2v1_c31__hh_vbf > mdnn__v2__kl1_c2v1_c31__dy)
mpp_tth_v2    = (mdnn__v2__kl1_c2v1_c31__tth    > mdnn__v2__kl1_c2v1_c31__hh_ggf) && (mdnn__v2__kl1_c2v1_c31__tth    > mdnn__v2__kl1_c2v1_c31__hh_vbf) && (mdnn__v2__kl1_c2v1_c31__tth    > mdnn__v2__kl1_c2v1_c31__tt_lep) && (mdnn__v2__kl1_c2v1_c31__tth    > mdnn__v2__kl1_c2v1_c31__tt_fh)  && (mdnn__v2__kl1_c2v1_c31__tth    > mdnn__v2__kl1_c2v1_c31__dy)
mpp_ttlep_v2  = (mdnn__v2__kl1_c2v1_c31__tt_lep > mdnn__v2__kl1_c2v1_c31__hh_ggf) && (mdnn__v2__kl1_c2v1_c31__tt_lep > mdnn__v2__kl1_c2v1_c31__hh_vbf) && (mdnn__v2__kl1_c2v1_c31__tt_lep > mdnn__v2__kl1_c2v1_c31__tth)    && (mdnn__v2__kl1_c2v1_c31__tt_lep > mdnn__v2__kl1_c2v1_c31__tt_fh)  && (mdnn__v2__kl1_c2v1_c31__tt_lep > mdnn__v2__kl1_c2v1_c31__dy)
mpp_tthad_v2  = (mdnn__v2__kl1_c2v1_c31__tt_fh  > mdnn__v2__kl1_c2v1_c31__hh_ggf) && (mdnn__v2__kl1_c2v1_c31__tt_fh  > mdnn__v2__kl1_c2v1_c31__hh_vbf) && (mdnn__v2__kl1_c2v1_c31__tt_fh  > mdnn__v2__kl1_c2v1_c31__tth)    && (mdnn__v2__kl1_c2v1_c31__tt_fh  > mdnn__v2__kl1_c2v1_c31__tt_lep) && (mdnn__v2__kl1_c2v1_c31__tt_fh  > mdnn__v2__kl1_c2v1_c31__dy)
mpp_dy_v2     = (mdnn__v2__kl1_c2v1_c31__dy     > mdnn__v2__kl1_c2v1_c31__hh_ggf) && (mdnn__v2__kl1_c2v1_c31__dy     > mdnn__v2__kl1_c2v1_c31__hh_vbf) && (mdnn__v2__kl1_c2v1_c31__dy     > mdnn__v2__kl1_c2v1_c31__tth)    && (mdnn__v2__kl1_c2v1_c31__dy     > mdnn__v2__kl1_c2v1_c31__tt_lep) && (mdnn__v2__kl1_c2v1_c31__dy     > mdnn__v2__kl1_c2v1_c31__tt_fh)

# replace v1 <-> v2 depending on which training is being used
GGFclass    = VBFloose, mpp_ggf_v2
VBFclass    = VBFloose, mpp_vbf_v2
ttHclass    = VBFloose, mpp_tth_v2
TTlepclass  = VBFloose, mpp_ttlep_v2
TThadclass  = VBFloose, mpp_tthad_v2
DYclass     = VBFloose, mpp_dy_v2


# DY study
baseline_MTcut    = baseline, MTcut
baselineHTT_MTcut = baselineHTT, MTcut
antiB_MTcut       = antiB, MTcut
antiBHTT_MTcut    = antiBHTT, MTcut

baseline_minHmass    = baseline, minHmass
baselineHTT_minHmass = baselineHTT, minHmass
antiB_minHmass       = antiB, minHmass
antiBHTT_minHmass    = antiBHTT, minHmass

baseline_METCut    = baseline, METCut
baseline_invMETCut = baseline, invMETCut

baseline_MTcut_invMETCut = baseline, MTcut, invMETCut
baseline_MTcutTight      = baseline, MTcutTight
antiB_invMETCut          = antiB, invMETCut
antiB_MTcutTight         = antiB, MTcutTight
antiB_MTcut_invMETCut    = antiB, MTcut, invMETCut

baselineHTT_MTcutTight      = baselineHTT, MTcutTight
baselineHTT_invMETCut       = baselineHTT, invMETCut
baselineHTT_MTcut_invMETCut = baselineHTT, MTcut, invMETCut
antiBHTT_MTcutTight         = antiBHTT, MTcutTight
antiBHTT_invMETCut          = antiBHTT, invMETCut
antiBHTT_MTcut_invMETCut    = antiBHTT, MTcut, invMETCut

DYregHTT                      = baselineHTT, nobtagM
DYregHTT_MTcut                = baselineHTT, nobtagM, MTcut
DYregHTT_MTcutTight           = baselineHTT, nobtagM, MTcutTight
DYregHTT_invMETCut            = baselineHTT, nobtagM, invMETCut
DYregHTT_MTcut_invMETCut      = baselineHTT, nobtagM, MTcut, invMETCut
DYregHTT_MTcutTight_invMETCut = baselineHTT, nobtagM, MTcutTight, invMETCut
DYregHTT_MTcutTight_invMETCut_minHmass = baselineHTT, nobtagM, MTcutTight, invMETCut, minHmass
DYregHTT_MTcutTight_invMETCut_single = baselineHTT_single, nobtagM, MTcutTight, invMETCut
DYregHTT_MTcutTight_invMETCut_cross  = baselineHTT_cross , nobtagM, MTcutTight, invMETCut
DYregHTT_MTcutTight_invMETCut_minHmass_single = baselineHTT_single, nobtagM, MTcutTight, invMETCut, minHmass
DYregHTT_MTcutTight_invMETCut_minHmass_cross  = baselineHTT_cross , nobtagM, MTcutTight, invMETCut, minHmass


#########################################################################
#########################################################################

## weights to be applied for a certain selections when calling Fill()
## multiple weights are passed as list and are multiplied together
## NOTE: no weight is applied for data (the simple Fill() is used)
[selectionWeights]
baseline       = MC_weight, PUReweight, PUjetID_SF, L1pref_weight, prescaleWeight, trigSF, IdAndIsoAndFakeSF_deep_pt, DYscale_MTT
#baseline       = MC_weight, PUReweight, PUjetID_SF, L1pref_weight, prescaleWeight, trigSF, IdAndIsoAndFakeSF_deep, DYscale_MTT
#baseline      = MC_weight, PUReweight, L1pref_weight, trigSF, IdAndIsoAndFakeSF_deep, DYscale_MTT
#baselineHTT   = MC_weight, PUReweight, IdAndIsoSF, trigSF, FakeRateSF
#baselineHTT_S = MC_weight, PUReweight, IdAndIsoSF, trigSF_single, FakeRateSF
#baselineHTT_C = MC_weight, PUReweight, IdAndIsoSF, trigSF_cross , FakeRateSF

btagLL   = bTagweightL
btagMM   = bTagweightM
nobtagMM = bTagweightM
btagL    = bTagweightL
btagM    = bTagweightM
btagMfirst = bTagweightM

#########################################################################
#########################################################################

[sampleWeights]
#TTfullyHad = TTtopPtreweight
#TTfullyLep = TTtopPtreweight
#TTsemiLep  = TTtopPtreweight
#DY = DYLOtoNLOreweight

#########################################################################
#########################################################################

# define alternative weights to be tested instead of the nominal one
[systematics]
TTtopPtreweight      = topUp:TTtopPtreweight_up , topDown:TTtopPtreweight_down
trigSF_DM0           = trigSFDM0Up:trigSF_DM0_up , trigSFDM0Down:trigSF_DM0_down
trigSF_DM1           = trigSFDM1Up:trigSF_DM1_up , trigSFDM1Down:trigSF_DM1_down
trigSF_DM10          = trigSFDM10Up:trigSF_DM10_up , trigSFDM10Down:trigSF_DM10_down
trigSF_DM11          = trigSFDM11Up:trigSF_DM11_up , trigSFDM11Down:trigSF_DM11_down
tauid_pt20to25       = tauid_pt20to25Up:idAndIsoAndFakeSF_tauid_pt20to25_up   , tauid_pt20to25Down:idAndIsoAndFakeSF_tauid_pt20to25_down
tauid_pt25to30       = tauid_pt25to30Up:idAndIsoAndFakeSF_tauid_pt25to30_up   , tauid_pt25to30Down:idAndIsoAndFakeSF_tauid_pt25to30_down
tauid_pt30to35       = tauid_pt30to35Up:idAndIsoAndFakeSF_tauid_pt30to35_up   , tauid_pt30to35Down:idAndIsoAndFakeSF_tauid_pt30to35_down
tauid_pt35to40       = tauid_pt35to40Up:idAndIsoAndFakeSF_tauid_pt35to40_up   , tauid_pt35to40Down:idAndIsoAndFakeSF_tauid_pt35to40_down
tauid_pt40toInf      = tauid_pt40toInfUp:idAndIsoAndFakeSF_tauid_pt40toInf_up , tauid_pt40toInfDown:idAndIsoAndFakeSF_tauid_pt40toInf_down
mutauFR_etaLt0p4     = mutauFR_etaLt0p4Up:idAndIsoAndFakeSF_mutauFR_etaLt0p4_up       , mutauFR_etaLt0p4Down:idAndIsoAndFakeSF_mutauFR_etaLt0p4_down
mutauFR_eta0p4to0p8  = mutauFR_eta0p4to0p8Up:idAndIsoAndFakeSF_mutauFR_eta0p4to0p8_up , mutauFR_eta0p4to0p8Down:idAndIsoAndFakeSF_mutauFR_eta0p4to0p8_dowm
mutauFR_eta0p8to1p2  = mutauFR_eta0p8to1p2Up:idAndIsoAndFakeSF_mutauFR_eta0p8to1p2_up , mutauFR_eta0p8to1p2Down:idAndIsoAndFakeSF_mutauFR_eta0p8to1p2_dowm
mutauFR_eta1p2to1p7  = mutauFR_eta1p2to1p7Up:idAndIsoAndFakeSF_mutauFR_eta1p2to1p7_up , mutauFR_eta1p2to1p7Down:idAndIsoAndFakeSF_mutauFR_eta1p2to1p7_dowm
mutauFR_etaGt1p7     = mutauFR_etaGt1p7Up:idAndIsoAndFakeSF_mutauFR_etaGt1p7_up       , mutauFR_etaGt1p7Down:idAndIsoAndFakeSF_mutauFR_etaGt1p7_down
etauFR_barrel        = etauFR_barrelUp:idAndIsoAndFakeSF_etauFR_barrel_up , etauFR_barrelDown:idAndIsoAndFakeSF_etauFR_barrel_down
etauFR_endcap        = etauFR_endcapUp:idAndIsoAndFakeSF_etauFR_endcap_up , etauFR_endcapDown:idAndIsoAndFakeSF_etauFR_endcap_down

#########################################################################
#########################################################################

# ROOT-like definition of the binning
[histos]
mT                = 20, 0, 200
HH_pt             = 50, 0, 500
HHsvfit_pt        = 50, 0, 500
HHKin_mass        = 50, 250, 1000
bjet1_bID         = 50, 0., 1.
bjet2_bID         = 50, 0., 1.
bjet1_bID_deepCSV = 50, -1., 1.
bjet2_bID_deepCSV = 50, -1., 1.
HH_deltaPhi       = 15, 0., 3.14159
tauHMet_deltaPhi  = 15, 0., 3.14159
bHMet_deltaPhi    = 15, 0., 3.14159
ditau_deltaPhi    = 15, 0., 3.14159
dib_deltaPhi      = 15, 0., 3.14159
ditau_deltaEta    = 20, 0, 10
# dau1_pt           = 200, 23, 403
dau1_pt           = 40, 0, 200
dau1_eta          = 25, -2.5, 2.5
dau1_phi          = 25, -3.14159, 3.14159
dau1_iso          = 24, 0, 8
# dau2_pt           = 20, 0, 400
dau2_pt           = 40, 0, 200
dau2_eta          = 25, -2.5, 2.5
dau2_phi          = 25, -3.14159, 3.14159
dau2_iso          = 24, 0, 8
bjet1_pt          = 30, 0, 300
bjet2_pt          = 30, 0, 300
bjet1_eta         = 25, -2.4, 2.4
bjet2_eta         = 25, -2.4, 2.4
bjet1_phi         = 25, -3.14159, 3.14159
bjet2_phi         = 25, -3.14159, 3.14159
met_et            = 35,0,350
met_phi           = 25, -0.2, 6.3
met_er_et         = 30, 0, 600
met_er_phi        = 25, -3.14159, 3.14159
# bH_mass           = 25, 10, 510
# bH_mass           = 50, 0, 300
bH_mass           = 50, 0, 500
tauH_mass         = 25, 10, 510
bH_mass_raw       = 50, 0, 300
# tauH_SVFIT_mass   = 25, 0, 500
tauH_SVFIT_mass   = 50, 0, 500
HHmass            = 25, 0, 1000
njets             = 20,-0.5,19.5
npv               = 50, 0, 50
tauHMetdeltaPhi   = 25, 0, 3.15
bHMetdeltaPhi     = 25, 0, 3.15
ditau_deltaR       = 25, 0, 5
dib_deltaR         = 25, 0, 5
dau1MET_deltaphi       = 25, 0, 3.14159
tauHsvfitMet_deltaPhi = 25, 0, 3.14159
mT1                   = 20, 0, 200.
mT2                   = 20, 0, 200.
HHsvfit_deltaPhi      = 25, 0, 3.14159
dib_deltaR_per_bHpt          = 60, 0, 600
ditau_deltaR_per_tauHsvfitpt = 60, 0, 600
BDTResonant           = 25,-1,1
# BDTResonantLM         = 25,-1,1
# BDTResonantHM         = 25,-1,1
BDTResonantLM         = 2500,-1,1
BDTResonantHM         = 2500,-1,1
BDTNonResonant        = 25,-1,1
LepTauKine            = 25,-0.94,0.94
genDecMode1           = 10, -2, 8
dau1_dxy           = 100, -0.01, 0.01
dau1_dz            = 100, -0.1, 0.1
fatjet_softdropMass = 50, 0, 300
jet3_eta        = 25, -5, 5
jet4_eta        = 25, -5, 5

HH_deltaR            = 35, 0, 7
tauH_pt              = 20, 0, 300
VBFjj_dEtaSign       = 40, -20, 20
dib_dEtaSign         = 40, -20, 20
VBFjj_deltaEta       = 20, 0, 10
VBFjj_mass           = 20, 0, 1500
VBFjet2_pt           = 20, 0, 500
bH_VBF1_deltaEta     = 10, 0, 10
VBFjet1_btag_deepCSV = 20, -1, 1
VBFjet1_pt           = 20, 0, 500
VBFjet2_PUjetID      = 20, -1, 1

BDT_MET_bH_cosTheta = 20,  -1,   1
BDT_HT20            = 20,   0, 400
bH_pt               = 20,   0, 400
p_zeta              = 30, -50, 250
HH_zV               = 40, -10, 10
BDT_topPairMasses   = 30, 0, 600

BDToutVBF           = 40, -1, 1

BDToutSM_kl_1            = 15,-1,1
BDToutLM_spin_0_mass_280 = 20,-1,1
BDToutMM_spin_0_mass_400 = 20,-1,1
BDToutHM_spin_0_mass_650 = 20,-1,1

DNNoutSM_kl_1     = 20, 0, 1
DNNoutSM_kl_1_new = 20, 0, 1
DNNoutSM_kl_5_new = 20, 0, 1

#########################################################################
#########################################################################

# user defined binning for a variable - has precedence on [histos]
[binning]
HH_mass             = 200, 250, 300, 350, 450, 600, 1000
# HH_mass_raw         = 200, 225, 250, 275, 300, 325, 350, 400, 450, 500, 550, 600, 1000 # temp for mass sideband control
# HH_mass_raw         = 200, 250, 300, 350, 450, 600, 1000
# HH_mass_raw_tauup   = 200, 250, 300, 350, 450, 600, 1000
# HH_mass_raw_taudown = 200, 250, 300, 350, 450, 600, 1000
HHKin_mass          = 250, 275, 300, 350, 400, 450, 500, 600, 700, 850, 1000, 1600
# HHKin_mass_raw      = 250, 275, 300, 350, 400, 450, 500, 600, 700, 850, 1000, 1600
# HHKin_mass_raw      = 250, 275, 300, 350, 400, 450, 500, 600, 700, 850, 1000
# HH_mass_raw          = 0, 100, 200, 225, 250, 260, 270, 280, 290, 300, 325, 350, 375, 400, 425, 450, 475, 500, 550, 600, 650, 700, 850, 1000
HH_mass_raw             = 0, 100, 120, 140, 160, 180, 200, 225, 250, 275, 300, 325, 350, 375, 400, 500
HHsvfit_mass            = 0, 100, 120, 140, 160, 180, 200, 225, 250, 275, 300, 325, 350, 375, 400, 500

HHKin_mass_raw          = 250, 260, 270, 280, 290, 300, 325, 350, 375, 400, 425, 450, 475, 500, 550, 600, 650, 700, 850, 1000
HHKin_mass_raw_tauup    = 250, 260, 270, 280, 290, 300, 325, 350, 375, 400, 425, 450, 475, 500, 550, 600, 650, 700, 850, 1000
HHKin_mass_raw_taudown  = 250, 260, 270, 280, 290, 300, 325, 350, 375, 400, 425, 450, 475, 500, 550, 600, 650, 700, 850, 1000
HHKin_mass_raw_jetup    = 250, 260, 270, 280, 290, 300, 325, 350, 375, 400, 425, 450, 475, 500, 550, 600, 650, 700, 850, 1000
HHKin_mass_raw_jetdown  = 250, 260, 270, 280, 290, 300, 325, 350, 375, 400, 425, 450, 475, 500, 550, 600, 650, 700, 850, 1000

bH_mass             = 10, 35, 60, 85, 110, 135, 160, 185, 210, 250, 300, 350, 400, 500
# bH_mass_raw         = 10, 35, 60, 85, 110, 135, 160, 185, 210, 250, 300, 350, 400, 500
# bH_mass_raw         = 10, 35, 60, 85, 110, 135, 160, 185, 210, 250, 300, 350, 400, 500
# fatjet_softdropMass = 10, 35, 60, 85, 110, 135, 160, 185, 210, 250, 300, 350, 400, 500
# tauH_SVFIT_mass     = 10, 35, 60, 85, 110, 135, 160, 185, 210, 250, 300, 350, 400, 500
# MT2                 = 0, 25, 50, 75, 100, 125, 150, 175, 200, 250, 300, 350, 500, 600

# MT2                 = 0, 12.5, 25, 37.5, 50, 62.5, 75, 87.5, 100, 125, 150, 175, 200, 250, 300, 500 # temp for mass sideband control
MT2                 = 0, 25, 50, 75, 100, 125, 150, 175, 200, 250, 300, 500
MT2_tauup           = 0, 25, 50, 75, 100, 125, 150, 175, 200, 250, 300, 500
MT2_taudown         = 0, 25, 50, 75, 100, 125, 150, 175, 200, 250, 300, 500
MT2_jetup           = 0, 25, 50, 75, 100, 125, 150, 175, 200, 250, 300, 500
MT2_jetdown         = 0, 25, 50, 75, 100, 125, 150, 175, 200, 250, 300, 500

mdnn__v1__kl1_c2v1_c31__hh_ggf  = 0.16, 0.363, 0.433, 0.5028, 0.586, 0.7182, 1.0
mdnn__v1__kl1_c2v1_c31__hh_vbf  = 0.16, 0.3784, 0.528, 0.6842, 1.0
mdnn__v1__kl1_c2v1_c31__tth     = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958
mdnn__v1__kl1_c2v1_c31__tt_lep  = 0.16, 0.3448, 0.3868, 0.4182, 0.4489, 0.4796, 0.5103, 0.541, 0.5717, 0.6024, 0.633, 0.6636, 0.6942, 0.7248, 0.7554, 0.786, 0.8166, 0.8472, 0.8778, 0.9084, 1.0
mdnn__v1__kl1_c2v1_c31__tt_fh   = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958
mdnn__v1__kl1_c2v1_c31__dy      = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958

mdnn__v2__kl1_c2v1_c31__hh_ggf  = 0.16, 0.363, 0.433, 0.5028, 0.586, 0.7182, 1.0
mdnn__v2__kl1_c2v1_c31__hh_vbf  = 0.16, 0.3784, 0.528, 0.6842, 1.0
mdnn__v2__kl1_c2v1_c31__tth     = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958
mdnn__v2__kl1_c2v1_c31__tt_lep  = 0.16, 0.3448, 0.3868, 0.4182, 0.4489, 0.4796, 0.5103, 0.541, 0.5717, 0.6024, 0.633, 0.6636, 0.6942, 0.7248, 0.7554, 0.786, 0.8166, 0.8472, 0.8778, 0.9084, 1.0
mdnn__v2__kl1_c2v1_c31__tt_fh   = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958
mdnn__v2__kl1_c2v1_c31__dy      = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958

#########################################################################
#########################################################################

[histos2D]
tauH_SVFIT_mass:bH_mass_raw = 100, 0, 500, 100, 0, 500
tauH_SVFIT_mass:bH_mass     = 100, 0, 500, 100, 0, 500
tauH_SVFIT_mass:dau1_pt     = 100, 0, 500, 100, 0, 500
tauH_mass:bH_mass           = 100, 0, 500, 100, 0, 500
genDecMode1:genDecMode2     = 10, -2,   8, 10, -2, 8
VBFjj_deltaEta:VBFjj_mass   = 40,  0,  10, 80,  0, 4000

# user defined binning for a variable - will override the definition in [histos2D]
# NOTE: if both x and y binnings are defined, there is no need to insert a binning in [histos2D]
# note: to specify an user binning for a certain axis of a 2D plot, e.g. a binning for B in A:B, use '@' :
# A:B@B = 0, 15, 20, 30, 50, 1000
[binning2D]
# tauH_SVFIT_mass:bH_mass_raw@bH_mass_raw     = 10, 35, 60, 85, 110, 135, 160, 185, 210, 250, 300, 350, 400, 500
# tauH_SVFIT_mass:bH_mass_raw@tauH_SVfit_mass = 10, 35, 60, 85, 110, 135, 160, 185, 210, 250, 300, 350, 400, 500
