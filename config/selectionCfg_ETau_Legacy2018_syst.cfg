# the definition of composed selections. Can contain as well TCut style selections, e.g.:
# resolved = baseline, btagMM, massCut
# resolvedHighPt = baseline, btagMM, massCut, dau1_pt > 150
# use comma separated lists
[selections]

# btag requirements - DeepFlavor WPs={0.0494, 0.2770, 0.7264}; // L,M,T -- Legacy 2018 DeepFlavor
btagL        = (bjet1_bID_deepFlavor > 0.0494 && bjet2_bID_deepFlavor < 0.0494) || (bjet1_bID_deepFlavor < 0.0494 && bjet2_bID_deepFlavor > 0.0494) #only 1 jet with loose btag working point
btagM        = (bjet1_bID_deepFlavor > 0.2770 && bjet2_bID_deepFlavor < 0.2770) || (bjet1_bID_deepFlavor < 0.2770 && bjet2_bID_deepFlavor > 0.2770) #only 1 jet with medium btag working point
btagMfirst   = (bjet1_bID_deepFlavor > 0.2770) || (bjet2_bID_deepFlavor > 0.2770)                                                                   #at least 1 jet with medium btag working point
btagLL       = bjet1_bID_deepFlavor > 0.0494 && bjet2_bID_deepFlavor > 0.0494 #both jets with loose btag working point
btagMM       = bjet1_bID_deepFlavor > 0.2770 && bjet2_bID_deepFlavor > 0.2770 #both jets with medium btag working point
nobtagMM     = bjet1_bID_deepFlavor < 0.2770 && bjet2_bID_deepFlavor < 0.2770 #both jets NOT btagged (medium working point)

# Signal Region: opposite sign, isolated taus
SR = isOS != 0 && dau1_eleMVAiso == 1 && dau2_deepTauVsJet >= 5

# VBF "multi-categories"
mpp_ggf_v2    = (mdnn__v2__kl1_c2v1_c31__hh_ggf > mdnn__v2__kl1_c2v1_c31__hh_vbf) && (mdnn__v2__kl1_c2v1_c31__hh_ggf > mdnn__v2__kl1_c2v1_c31__tth)    && (mdnn__v2__kl1_c2v1_c31__hh_ggf > mdnn__v2__kl1_c2v1_c31__tt_lep) && (mdnn__v2__kl1_c2v1_c31__hh_ggf > mdnn__v2__kl1_c2v1_c31__tt_fh)  && (mdnn__v2__kl1_c2v1_c31__hh_ggf > mdnn__v2__kl1_c2v1_c31__dy)
mpp_vbf_v2    = (mdnn__v2__kl1_c2v1_c31__hh_vbf > mdnn__v2__kl1_c2v1_c31__hh_ggf) && (mdnn__v2__kl1_c2v1_c31__hh_vbf > mdnn__v2__kl1_c2v1_c31__tth)    && (mdnn__v2__kl1_c2v1_c31__hh_vbf > mdnn__v2__kl1_c2v1_c31__tt_lep) && (mdnn__v2__kl1_c2v1_c31__hh_vbf > mdnn__v2__kl1_c2v1_c31__tt_fh)  && (mdnn__v2__kl1_c2v1_c31__hh_vbf > mdnn__v2__kl1_c2v1_c31__dy)
mpp_tth_v2    = (mdnn__v2__kl1_c2v1_c31__tth    > mdnn__v2__kl1_c2v1_c31__hh_ggf) && (mdnn__v2__kl1_c2v1_c31__tth    > mdnn__v2__kl1_c2v1_c31__hh_vbf) && (mdnn__v2__kl1_c2v1_c31__tth    > mdnn__v2__kl1_c2v1_c31__tt_lep) && (mdnn__v2__kl1_c2v1_c31__tth    > mdnn__v2__kl1_c2v1_c31__tt_fh)  && (mdnn__v2__kl1_c2v1_c31__tth    > mdnn__v2__kl1_c2v1_c31__dy)
mpp_ttlep_v2  = (mdnn__v2__kl1_c2v1_c31__tt_lep > mdnn__v2__kl1_c2v1_c31__hh_ggf) && (mdnn__v2__kl1_c2v1_c31__tt_lep > mdnn__v2__kl1_c2v1_c31__hh_vbf) && (mdnn__v2__kl1_c2v1_c31__tt_lep > mdnn__v2__kl1_c2v1_c31__tth)    && (mdnn__v2__kl1_c2v1_c31__tt_lep > mdnn__v2__kl1_c2v1_c31__tt_fh)  && (mdnn__v2__kl1_c2v1_c31__tt_lep > mdnn__v2__kl1_c2v1_c31__dy)
mpp_tthad_v2  = (mdnn__v2__kl1_c2v1_c31__tt_fh  > mdnn__v2__kl1_c2v1_c31__hh_ggf) && (mdnn__v2__kl1_c2v1_c31__tt_fh  > mdnn__v2__kl1_c2v1_c31__hh_vbf) && (mdnn__v2__kl1_c2v1_c31__tt_fh  > mdnn__v2__kl1_c2v1_c31__tth)    && (mdnn__v2__kl1_c2v1_c31__tt_fh  > mdnn__v2__kl1_c2v1_c31__tt_lep) && (mdnn__v2__kl1_c2v1_c31__tt_fh  > mdnn__v2__kl1_c2v1_c31__dy)
mpp_dy_v2     = (mdnn__v2__kl1_c2v1_c31__dy     > mdnn__v2__kl1_c2v1_c31__hh_ggf) && (mdnn__v2__kl1_c2v1_c31__dy     > mdnn__v2__kl1_c2v1_c31__hh_vbf) && (mdnn__v2__kl1_c2v1_c31__dy     > mdnn__v2__kl1_c2v1_c31__tth)    && (mdnn__v2__kl1_c2v1_c31__dy     > mdnn__v2__kl1_c2v1_c31__tt_lep) && (mdnn__v2__kl1_c2v1_c31__dy     > mdnn__v2__kl1_c2v1_c31__tt_fh)

### -- Selections with tes/mes/ees
### when shifting up/down the tauh --> we evaluate acceptance requiring +5 GeV on the threshold
### dau1 == Electron --> not shifted --> no change in acceptance --> no change in threshold
### jets are unshifted by this --> left to the nominal threshold
### -- Selections with jes
### jets are selected at skim level to have pt > 20
### so I am raising the pt value to 25 just to test the change in the acceptance
### taus are unshifted by this --> left to the nominal threshold

###### baselines
baseline_nominal      = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt              > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1

baseline_tesUp_DM0    = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_tauup_DM0    > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_tesDown_DM0  = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_taudown_DM0  > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_tesUp_DM1    = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_tauup_DM1    > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_tesDown_DM1  = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_taudown_DM1  > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_tesUp_DM10   = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_tauup_DM10   > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_tesDown_DM10 = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_taudown_DM10 > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_tesUp_DM11   = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_tauup_DM11   > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_tesDown_DM11 = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_taudown_DM11 > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1

baseline_eesUp_DM0    = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_eleup_DM0    > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_eesDown_DM0  = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_eledown_DM0  > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_eesUp_DM1    = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_eleup_DM1    > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_eesDown_DM1  = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_eledown_DM1  > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1

baseline_mesUp        = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_muup         > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1
baseline_mesDown      = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt_mudown       > 25 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt > 20 && bjet2_pt > 20 && nbjetscand > 1

baseline_jesUp_Tot    = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt              > 20 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt_raw_jetupTot   > 25 && bjet2_pt_raw_jetupTot   > 25 && nbjetscand > 1
baseline_jesDown_Tot  = pairType == 1 && dau1_pt > 20 && abs (dau1_eta) < 2.1 && dau2_pt              > 20 && abs (dau2_eta) < 2.3 && nleps == 0 && bjet1_pt_raw_jetdownTot > 25 && bjet1_pt_raw_jetdownTot > 25 && nbjetscand > 1


###### masscuts
# old mass cuts used in 2016 paper
# boostMassCut  = tauH_SVFIT_mass > 79.5 && tauH_SVFIT_mass < 152.5 && fatjet_softdropMass > 90 && fatjet_softdropMass < 160
# ellypsMassCut = ((tauH_SVFIT_mass-116.)*(tauH_SVFIT_mass-116.))/(35.*35.) + ((bH_mass_raw-111.)*(bH_mass_raw-111.))/(45.*45.) <  1.0

# updated mass cuts for Run2 Legacy, to be used with DNN 2020-07-31 (both ellyptical)
# https://github.com/GilesStrong/cms_runII_dnn_models#mass-cuts
boostMassCut  = ((tauH_SVFIT_mass-128.)*(tauH_SVFIT_mass-128.))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.)   <  1.0
ellypsMassCut = ((tauH_SVFIT_mass-129.)*(tauH_SVFIT_mass-129.))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0

ellypsMassCut_tesUp_DM0    = ((tauH_SVFIT_mass_tauup_DM0-129.   )*(tauH_SVFIT_mass_tauup_DM0-129.   ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_tesDown_DM0  = ((tauH_SVFIT_mass_taudown_DM0-129. )*(tauH_SVFIT_mass_taudown_DM0-129. ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_tesUp_DM1    = ((tauH_SVFIT_mass_tauup_DM1-129.   )*(tauH_SVFIT_mass_tauup_DM1-129.   ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_tesDown_DM1  = ((tauH_SVFIT_mass_taudown_DM1-129. )*(tauH_SVFIT_mass_taudown_DM1-129. ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_tesUp_DM10   = ((tauH_SVFIT_mass_tauup_DM10-129.  )*(tauH_SVFIT_mass_tauup_DM10-129.  ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_tesDown_DM10 = ((tauH_SVFIT_mass_taudown_DM10-129.)*(tauH_SVFIT_mass_taudown_DM10-129.))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_tesUp_DM11   = ((tauH_SVFIT_mass_tauup_DM11-129.  )*(tauH_SVFIT_mass_tauup_DM11-129.  ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_tesDown_DM11 = ((tauH_SVFIT_mass_taudown_DM11-129.)*(tauH_SVFIT_mass_taudown_DM11-129.))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0

ellypsMassCut_eesUp_DM0    = ((tauH_SVFIT_mass_eleup_DM0-129.   )*(tauH_SVFIT_mass_eleup_DM0-129.   ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_eesDown_DM0  = ((tauH_SVFIT_mass_eledown_DM0-129. )*(tauH_SVFIT_mass_eledown_DM0-129. ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_eesUp_DM1    = ((tauH_SVFIT_mass_eleup_DM1-129.   )*(tauH_SVFIT_mass_eleup_DM1-129.   ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_eesDown_DM1  = ((tauH_SVFIT_mass_eledown_DM1-129. )*(tauH_SVFIT_mass_eledown_DM1-129. ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0

ellypsMassCut_mesUp        = ((tauH_SVFIT_mass_muup-129.        )*(tauH_SVFIT_mass_muup-129.        ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0
ellypsMassCut_mesDown      = ((tauH_SVFIT_mass_mudown-129.      )*(tauH_SVFIT_mass_mudown-129.      ))/(53.*53.) + ((bH_mass_raw-169.)*(bH_mass_raw-169.))/(145.*145.) <  1.0

ellypsMassCut_jesUp_Tot    = ((tauH_SVFIT_mass_jetupTot-129.    )*(tauH_SVFIT_mass_jetupTot-129.    ))/(53.*53.) + ((bH_mass_raw_jetupTot-169.  )*(bH_mass_raw_jetupTot-169.  ))/(145.*145.) <  1.0
ellypsMassCut_jesDown_Tot  = ((tauH_SVFIT_mass_jetdownTot-129.  )*(tauH_SVFIT_mass_jetdownTot-129.  ))/(53.*53.) + ((bH_mass_raw_jetdownTot-169.)*(bH_mass_raw_jetdownTot-169.))/(145.*145.) <  1.0

boostMassCut_tesUp_DM0    = ((tauH_SVFIT_mass_tauup_DM0-128.   )*(tauH_SVFIT_mass_tauup_DM0-128.   ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_tesDown_DM0  = ((tauH_SVFIT_mass_taudown_DM0-128. )*(tauH_SVFIT_mass_taudown_DM0-128. ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_tesUp_DM1    = ((tauH_SVFIT_mass_tauup_DM1-128.   )*(tauH_SVFIT_mass_tauup_DM1-128.   ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_tesDown_DM1  = ((tauH_SVFIT_mass_taudown_DM1-128. )*(tauH_SVFIT_mass_taudown_DM1-128. ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_tesUp_DM10   = ((tauH_SVFIT_mass_tauup_DM10-128.  )*(tauH_SVFIT_mass_tauup_DM10-128.  ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_tesDown_DM10 = ((tauH_SVFIT_mass_taudown_DM10-128.)*(tauH_SVFIT_mass_taudown_DM10-128.))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_tesUp_DM11   = ((tauH_SVFIT_mass_tauup_DM11-128.  )*(tauH_SVFIT_mass_tauup_DM11-128.  ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_tesDown_DM11 = ((tauH_SVFIT_mass_taudown_DM11-128.)*(tauH_SVFIT_mass_taudown_DM11-128.))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0

boostMassCut_eesUp_DM0    = ((tauH_SVFIT_mass_eleup_DM0-128.   )*(tauH_SVFIT_mass_eleup_DM0-128.   ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_eesDown_DM0  = ((tauH_SVFIT_mass_eledown_DM0-128. )*(tauH_SVFIT_mass_eledown_DM0-128. ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_eesUp_DM1    = ((tauH_SVFIT_mass_eleup_DM1-128.   )*(tauH_SVFIT_mass_eleup_DM1-128.   ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_eesDown_DM1  = ((tauH_SVFIT_mass_eledown_DM1-128. )*(tauH_SVFIT_mass_eledown_DM1-128. ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0

boostMassCut_mesUp        = ((tauH_SVFIT_mass_muup-128.        )*(tauH_SVFIT_mass_muup-128.        ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0
boostMassCut_mesDown      = ((tauH_SVFIT_mass_mudown-128.      )*(tauH_SVFIT_mass_mudown-128.      ))/(60.*60.) + ((bH_mass_raw-159.)*(bH_mass_raw-159.))/(94.*94.) <  1.0

boostMassCut_jesUp_Tot    = ((tauH_SVFIT_mass_jetupTot-128.    )*(tauH_SVFIT_mass_jetupTot-128.    ))/(60.*60.) + ((bH_mass_raw_jetupTot-159.  )*(bH_mass_raw_jetupTot-159.  ))/(94.*94.) <  1.0
boostMassCut_jesDown_Tot  = ((tauH_SVFIT_mass_jetdownTot-128.  )*(tauH_SVFIT_mass_jetdownTot-128.  ))/(60.*60.) + ((bH_mass_raw_jetdownTot-159.)*(bH_mass_raw_jetdownTot-159.))/(94.*94.) <  1.0


###### VBF base
jetsVBFloose_nominal     = isVBF && VBFjj_mass            > 500 && VBFjj_deltaEta > 3
jetsVBFloose_jesUp_Tot   = isVBF && VBFjj_mass_jetupTot   > 500 && VBFjj_deltaEta > 3 && VBFjet2_pt_jetupTot   > 30
jetsVBFloose_jesDown_Tot = isVBF && VBFjj_mass_jetdownTot > 500 && VBFjj_deltaEta > 3 && VBFjet2_pt_jetdownTot > 30

noVBFloose_nominal       = !(isVBF && VBFjj_mass            > 500 && VBFjj_deltaEta > 3 && btagMfirst)
noVBFloose_jesUp_Tot     = !(isVBF && VBFjj_mass_jetupTot   > 500 && VBFjj_deltaEta > 3 && VBFjet2_pt_jetupTot   > 30 && btagMfirst)
noVBFloose_jesDown_Tot   = !(isVBF && VBFjj_mass_jetdownTot > 500 && VBFjj_deltaEta > 3 && VBFjet2_pt_jetdownTot > 30 && btagMfirst)


###### categories
s1b1jresolvedMcut_nominal      = baseline_nominal     , btagM , isBoosted != 1 , ellypsMassCut            , noVBFloose_nominal
s2b0jresolvedMcut_nominal      = baseline_nominal     , btagMM, isBoosted != 1 , ellypsMassCut            , noVBFloose_nominal
sboostedLLMcut_nominal         = baseline_nominal     , btagLL, isBoosted == 1 , boostMassCut             , noVBFloose_nominal
VBFloose_nominal               = baseline_nominal     , jetsVBFloose_nominal   , tauH_SVFIT_mass > 50     , btagMfirst
GGFclass_nominal               = VBFloose_nominal, mpp_ggf_v2
VBFclass_nominal               = VBFloose_nominal, mpp_vbf_v2
ttHclass_nominal               = VBFloose_nominal, mpp_tth_v2
TTlepclass_nominal             = VBFloose_nominal, mpp_ttlep_v2
TThadclass_nominal             = VBFloose_nominal, mpp_tthad_v2
DYclass_nominal                = VBFloose_nominal, mpp_dy_v2

s1b1jresolvedMcut_tesUp_DM0    = baseline_tesUp_DM0   , btagM , isBoosted != 1 , ellypsMassCut_tesUp_DM0  , noVBFloose_nominal
s1b1jresolvedMcut_tesDown_DM0  = baseline_tesDown_DM0 , btagM , isBoosted != 1 , ellypsMassCut_tesDown_DM0, noVBFloose_nominal
s2b0jresolvedMcut_tesUp_DM0    = baseline_tesUp_DM0   , btagMM, isBoosted != 1 , ellypsMassCut_tesUp_DM0  , noVBFloose_nominal
s2b0jresolvedMcut_tesDown_DM0  = baseline_tesDown_DM0 , btagMM, isBoosted != 1 , ellypsMassCut_tesDown_DM0, noVBFloose_nominal
sboostedLLMcut_tesUp_DM0       = baseline_tesUp_DM0   , btagLL, isBoosted == 1 , boostMassCut_tesUp_DM0   , noVBFloose_nominal
sboostedLLMcut_tesDown_DM0     = baseline_tesDown_DM0 , btagLL, isBoosted == 1 , boostMassCut_tesDown_DM0 , noVBFloose_nominal
VBFloose_tesUp_DM0             = baseline_tesUp_DM0   , jetsVBFloose_nominal   , tauH_SVFIT_mass_tauup_DM0   > 50, btagMfirst
VBFloose_tesDown_DM0           = baseline_tesDown_DM0 , jetsVBFloose_nominal   , tauH_SVFIT_mass_taudown_DM0 > 50, btagMfirst
GGFclass_tesUp_DM0             = VBFloose_tesUp_DM0   , mpp_ggf_v2
GGFclass_tesDown_DM0           = VBFloose_tesDown_DM0 , mpp_ggf_v2
VBFclass_tesUp_DM0             = VBFloose_tesUp_DM0   , mpp_vbf_v2
VBFclass_tesDown_DM0           = VBFloose_tesDown_DM0 , mpp_vbf_v2
ttHclass_tesUp_DM0             = VBFloose_tesUp_DM0   , mpp_tth_v2
ttHclass_tesDown_DM0           = VBFloose_tesDown_DM0 , mpp_tth_v2
TTlepclass_tesUp_DM0           = VBFloose_tesUp_DM0   , mpp_ttlep_v2
TTlepclass_tesDown_DM0         = VBFloose_tesDown_DM0 , mpp_ttlep_v2
TThadclass_tesUp_DM0           = VBFloose_tesUp_DM0   , mpp_tthad_v2
TThadclass_tesDown_DM0         = VBFloose_tesDown_DM0 , mpp_tthad_v2
DYclass_tesUp_DM0              = VBFloose_tesUp_DM0   , mpp_dy_v2
DYclass_tesDown_DM0            = VBFloose_tesDown_DM0 , mpp_dy_v2

s1b1jresolvedMcut_tesUp_DM1    = baseline_tesUp_DM1   , btagM , isBoosted != 1 , ellypsMassCut_tesUp_DM1  , noVBFloose_nominal
s1b1jresolvedMcut_tesDown_DM1  = baseline_tesDown_DM1 , btagM , isBoosted != 1 , ellypsMassCut_tesDown_DM1, noVBFloose_nominal
s2b0jresolvedMcut_tesUp_DM1    = baseline_tesUp_DM1   , btagMM, isBoosted != 1 , ellypsMassCut_tesUp_DM1  , noVBFloose_nominal
s2b0jresolvedMcut_tesDown_DM1  = baseline_tesDown_DM1 , btagMM, isBoosted != 1 , ellypsMassCut_tesDown_DM1, noVBFloose_nominal
sboostedLLMcut_tesUp_DM1       = baseline_tesUp_DM1   , btagLL, isBoosted == 1 , boostMassCut_tesUp_DM1   , noVBFloose_nominal
sboostedLLMcut_tesDown_DM1     = baseline_tesDown_DM1 , btagLL, isBoosted == 1 , boostMassCut_tesDown_DM1 , noVBFloose_nominal
VBFloose_tesUp_DM1             = baseline_tesUp_DM1   , jetsVBFloose_nominal   , tauH_SVFIT_mass_tauup_DM1   > 50, btagMfirst
VBFloose_tesDown_DM1           = baseline_tesDown_DM1 , jetsVBFloose_nominal   , tauH_SVFIT_mass_taudown_DM1 > 50, btagMfirst
GGFclass_tesUp_DM1             = VBFloose_tesUp_DM1   , mpp_ggf_v2
GGFclass_tesDown_DM1           = VBFloose_tesDown_DM1 , mpp_ggf_v2
VBFclass_tesUp_DM1             = VBFloose_tesUp_DM1   , mpp_vbf_v2
VBFclass_tesDown_DM1           = VBFloose_tesDown_DM1 , mpp_vbf_v2
ttHclass_tesUp_DM1             = VBFloose_tesUp_DM1   , mpp_tth_v2
ttHclass_tesDown_DM1           = VBFloose_tesDown_DM1 , mpp_tth_v2
TTlepclass_tesUp_DM1           = VBFloose_tesUp_DM1   , mpp_ttlep_v2
TTlepclass_tesDown_DM1         = VBFloose_tesDown_DM1 , mpp_ttlep_v2
TThadclass_tesUp_DM1           = VBFloose_tesUp_DM1   , mpp_tthad_v2
TThadclass_tesDown_DM1         = VBFloose_tesDown_DM1 , mpp_tthad_v2
DYclass_tesUp_DM1              = VBFloose_tesUp_DM1   , mpp_dy_v2
DYclass_tesDown_DM1            = VBFloose_tesDown_DM1 , mpp_dy_v2

s1b1jresolvedMcut_tesUp_DM10   = baseline_tesUp_DM10   , btagM , isBoosted != 1 , ellypsMassCut_tesUp_DM10  , noVBFloose_nominal
s1b1jresolvedMcut_tesDown_DM10 = baseline_tesDown_DM10 , btagM , isBoosted != 1 , ellypsMassCut_tesDown_DM10, noVBFloose_nominal
s2b0jresolvedMcut_tesUp_DM10   = baseline_tesUp_DM10   , btagMM, isBoosted != 1 , ellypsMassCut_tesUp_DM10  , noVBFloose_nominal
s2b0jresolvedMcut_tesDown_DM10 = baseline_tesDown_DM10 , btagMM, isBoosted != 1 , ellypsMassCut_tesDown_DM10, noVBFloose_nominal
sboostedLLMcut_tesUp_DM10      = baseline_tesUp_DM10   , btagLL, isBoosted == 1 , boostMassCut_tesUp_DM10   , noVBFloose_nominal
sboostedLLMcut_tesDown_DM10    = baseline_tesDown_DM10 , btagLL, isBoosted == 1 , boostMassCut_tesDown_DM10 , noVBFloose_nominal
VBFloose_tesUp_DM10            = baseline_tesUp_DM10   , jetsVBFloose_nominal   , tauH_SVFIT_mass_tauup_DM10   > 50, btagMfirst
VBFloose_tesDown_DM10          = baseline_tesDown_DM10 , jetsVBFloose_nominal   , tauH_SVFIT_mass_taudown_DM10 > 50, btagMfirst
GGFclass_tesUp_DM10            = VBFloose_tesUp_DM10   , mpp_ggf_v2
GGFclass_tesDown_DM10          = VBFloose_tesDown_DM10 , mpp_ggf_v2
VBFclass_tesUp_DM10            = VBFloose_tesUp_DM10   , mpp_vbf_v2
VBFclass_tesDown_DM10          = VBFloose_tesDown_DM10 , mpp_vbf_v2
ttHclass_tesUp_DM10            = VBFloose_tesUp_DM10   , mpp_tth_v2
ttHclass_tesDown_DM10          = VBFloose_tesDown_DM10 , mpp_tth_v2
TTlepclass_tesUp_DM10          = VBFloose_tesUp_DM10   , mpp_ttlep_v2
TTlepclass_tesDown_DM10        = VBFloose_tesDown_DM10 , mpp_ttlep_v2
TThadclass_tesUp_DM10          = VBFloose_tesUp_DM10   , mpp_tthad_v2
TThadclass_tesDown_DM10        = VBFloose_tesDown_DM10 , mpp_tthad_v2
DYclass_tesUp_DM10             = VBFloose_tesUp_DM10   , mpp_dy_v2
DYclass_tesDown_DM10           = VBFloose_tesDown_DM10 , mpp_dy_v2

s1b1jresolvedMcut_tesUp_DM11   = baseline_tesUp_DM11   , btagM , isBoosted != 1 , ellypsMassCut_tesUp_DM11  , noVBFloose_nominal
s1b1jresolvedMcut_tesDown_DM11 = baseline_tesDown_DM11 , btagM , isBoosted != 1 , ellypsMassCut_tesDown_DM11, noVBFloose_nominal
s2b0jresolvedMcut_tesUp_DM11   = baseline_tesUp_DM11   , btagMM, isBoosted != 1 , ellypsMassCut_tesUp_DM11  , noVBFloose_nominal
s2b0jresolvedMcut_tesDown_DM11 = baseline_tesDown_DM11 , btagMM, isBoosted != 1 , ellypsMassCut_tesDown_DM11, noVBFloose_nominal
sboostedLLMcut_tesUp_DM11      = baseline_tesUp_DM11   , btagLL, isBoosted == 1 , boostMassCut_tesUp_DM11   , noVBFloose_nominal
sboostedLLMcut_tesDown_DM11    = baseline_tesDown_DM11 , btagLL, isBoosted == 1 , boostMassCut_tesDown_DM11 , noVBFloose_nominal
VBFloose_tesUp_DM11            = baseline_tesUp_DM11   , jetsVBFloose_nominal   , tauH_SVFIT_mass_tauup_DM11   > 50, btagMfirst
VBFloose_tesDown_DM11          = baseline_tesDown_DM11 , jetsVBFloose_nominal   , tauH_SVFIT_mass_taudown_DM11 > 50, btagMfirst
GGFclass_tesUp_DM11            = VBFloose_tesUp_DM11   , mpp_ggf_v2
GGFclass_tesDown_DM11          = VBFloose_tesDown_DM11 , mpp_ggf_v2
VBFclass_tesUp_DM11            = VBFloose_tesUp_DM11   , mpp_vbf_v2
VBFclass_tesDown_DM11          = VBFloose_tesDown_DM11 , mpp_vbf_v2
ttHclass_tesUp_DM11            = VBFloose_tesUp_DM11   , mpp_tth_v2
ttHclass_tesDown_DM11          = VBFloose_tesDown_DM11 , mpp_tth_v2
TTlepclass_tesUp_DM11          = VBFloose_tesUp_DM11   , mpp_ttlep_v2
TTlepclass_tesDown_DM11        = VBFloose_tesDown_DM11 , mpp_ttlep_v2
TThadclass_tesUp_DM11          = VBFloose_tesUp_DM11   , mpp_tthad_v2
TThadclass_tesDown_DM11        = VBFloose_tesDown_DM11 , mpp_tthad_v2
DYclass_tesUp_DM11             = VBFloose_tesUp_DM11   , mpp_dy_v2
DYclass_tesDown_DM11           = VBFloose_tesDown_DM11 , mpp_dy_v2

s1b1jresolvedMcut_eesUp_DM0    = baseline_eesUp_DM0    , btagM , isBoosted != 1 , ellypsMassCut_eesUp_DM0  , noVBFloose_nominal
s1b1jresolvedMcut_eesDown_DM0  = baseline_eesDown_DM0  , btagM , isBoosted != 1 , ellypsMassCut_eesDown_DM0, noVBFloose_nominal
s2b0jresolvedMcut_eesUp_DM0    = baseline_eesUp_DM0    , btagMM, isBoosted != 1 , ellypsMassCut_eesUp_DM0  , noVBFloose_nominal
s2b0jresolvedMcut_eesDown_DM0  = baseline_eesDown_DM0  , btagMM, isBoosted != 1 , ellypsMassCut_eesDown_DM0, noVBFloose_nominal
sboostedLLMcut_eesUp_DM0       = baseline_eesUp_DM0    , btagLL, isBoosted == 1 , boostMassCut_eesUp_DM0   , noVBFloose_nominal
sboostedLLMcut_eesDown_DM0     = baseline_eesDown_DM0  , btagLL, isBoosted == 1 , boostMassCut_eesDown_DM0 , noVBFloose_nominal
VBFloose_eesUp_DM0             = baseline_eesUp_DM0    , jetsVBFloose_nominal   , tauH_SVFIT_mass_eleup_DM0   > 50, btagMfirst
VBFloose_eesDown_DM0           = baseline_eesDown_DM0  , jetsVBFloose_nominal   , tauH_SVFIT_mass_eledown_DM0 > 50, btagMfirst
GGFclass_eesUp_DM0             = VBFloose_eesUp_DM0   , mpp_ggf_v2
GGFclass_eesDown_DM0           = VBFloose_eesDown_DM0 , mpp_ggf_v2
VBFclass_eesUp_DM0             = VBFloose_eesUp_DM0   , mpp_vbf_v2
VBFclass_eesDown_DM0           = VBFloose_eesDown_DM0 , mpp_vbf_v2
ttHclass_eesUp_DM0             = VBFloose_eesUp_DM0   , mpp_tth_v2
ttHclass_eesDown_DM0           = VBFloose_eesDown_DM0 , mpp_tth_v2
TTlepclass_eesUp_DM0           = VBFloose_eesUp_DM0   , mpp_ttlep_v2
TTlepclass_eesDown_DM0         = VBFloose_eesDown_DM0 , mpp_ttlep_v2
TThadclass_eesUp_DM0           = VBFloose_eesUp_DM0   , mpp_tthad_v2
TThadclass_eesDown_DM0         = VBFloose_eesDown_DM0 , mpp_tthad_v2
DYclass_eesUp_DM0              = VBFloose_eesUp_DM0   , mpp_dy_v2
DYclass_eesDown_DM0            = VBFloose_eesDown_DM0 , mpp_dy_v2

s1b1jresolvedMcut_eesUp_DM1    = baseline_eesUp_DM1    , btagM , isBoosted != 1 , ellypsMassCut_eesUp_DM1  , noVBFloose_nominal
s1b1jresolvedMcut_eesDown_DM1  = baseline_eesDown_DM1  , btagM , isBoosted != 1 , ellypsMassCut_eesDown_DM1, noVBFloose_nominal
s2b0jresolvedMcut_eesUp_DM1    = baseline_eesUp_DM1    , btagMM, isBoosted != 1 , ellypsMassCut_eesUp_DM1  , noVBFloose_nominal
s2b0jresolvedMcut_eesDown_DM1  = baseline_eesDown_DM1  , btagMM, isBoosted != 1 , ellypsMassCut_eesDown_DM1, noVBFloose_nominal
sboostedLLMcut_eesUp_DM1       = baseline_eesUp_DM1    , btagLL, isBoosted == 1 , boostMassCut_eesUp_DM1   , noVBFloose_nominal
sboostedLLMcut_eesDown_DM1     = baseline_eesDown_DM1  , btagLL, isBoosted == 1 , boostMassCut_eesDown_DM1 , noVBFloose_nominal
VBFloose_eesUp_DM1             = baseline_eesUp_DM1    , jetsVBFloose_nominal   , tauH_SVFIT_mass_eleup_DM1   > 50, btagMfirst
VBFloose_eesDown_DM1           = baseline_eesDown_DM1  , jetsVBFloose_nominal   , tauH_SVFIT_mass_eledown_DM1 > 50, btagMfirst
GGFclass_eesUp_DM1             = VBFloose_eesUp_DM1   , mpp_ggf_v2
GGFclass_eesDown_DM1           = VBFloose_eesDown_DM1 , mpp_ggf_v2
VBFclass_eesUp_DM1             = VBFloose_eesUp_DM1   , mpp_vbf_v2
VBFclass_eesDown_DM1           = VBFloose_eesDown_DM1 , mpp_vbf_v2
ttHclass_eesUp_DM1             = VBFloose_eesUp_DM1   , mpp_tth_v2
ttHclass_eesDown_DM1           = VBFloose_eesDown_DM1 , mpp_tth_v2
TTlepclass_eesUp_DM1           = VBFloose_eesUp_DM1   , mpp_ttlep_v2
TTlepclass_eesDown_DM1         = VBFloose_eesDown_DM1 , mpp_ttlep_v2
TThadclass_eesUp_DM1           = VBFloose_eesUp_DM1   , mpp_tthad_v2
TThadclass_eesDown_DM1         = VBFloose_eesDown_DM1 , mpp_tthad_v2
DYclass_eesUp_DM1              = VBFloose_eesUp_DM1   , mpp_dy_v2
DYclass_eesDown_DM1            = VBFloose_eesDown_DM1 , mpp_dy_v2

s1b1jresolvedMcut_mesUp        = baseline_mesUp        , btagM , isBoosted != 1 , ellypsMassCut_mesUp      , noVBFloose_nominal
s1b1jresolvedMcut_mesDown      = baseline_mesDown      , btagM , isBoosted != 1 , ellypsMassCut_mesDown    , noVBFloose_nominal
s2b0jresolvedMcut_mesUp        = baseline_mesUp        , btagMM, isBoosted != 1 , ellypsMassCut_mesUp      , noVBFloose_nominal
s2b0jresolvedMcut_mesDown      = baseline_mesDown      , btagMM, isBoosted != 1 , ellypsMassCut_mesDown    , noVBFloose_nominal
sboostedLLMcut_mesUp           = baseline_mesUp        , btagLL, isBoosted == 1 , boostMassCut_mesUp       , noVBFloose_nominal
sboostedLLMcut_mesDown         = baseline_mesDown      , btagLL, isBoosted == 1 , boostMassCut_mesDown     , noVBFloose_nominal
VBFloose_mesUp                 = baseline_mesUp        , jetsVBFloose_nominal   , tauH_SVFIT_mass_muup   > 50, btagMfirst
VBFloose_mesDown               = baseline_mesDown      , jetsVBFloose_nominal   , tauH_SVFIT_mass_mudown > 50, btagMfirst
GGFclass_mesUp                 = VBFloose_mesUp        , mpp_ggf_v2
GGFclass_mesDown               = VBFloose_mesDown      , mpp_ggf_v2
VBFclass_mesUp                 = VBFloose_mesUp        , mpp_vbf_v2
VBFclass_mesDown               = VBFloose_mesDown      , mpp_vbf_v2
ttHclass_mesUp                 = VBFloose_mesUp        , mpp_tth_v2
ttHclass_mesDown               = VBFloose_mesDown      , mpp_tth_v2
TTlepclass_mesUp               = VBFloose_mesUp        , mpp_ttlep_v2
TTlepclass_mesDown             = VBFloose_mesDown      , mpp_ttlep_v2
TThadclass_mesUp               = VBFloose_mesUp        , mpp_tthad_v2
TThadclass_mesDown             = VBFloose_mesDown      , mpp_tthad_v2
DYclass_mesUp                  = VBFloose_mesUp        , mpp_dy_v2
DYclass_mesDown                = VBFloose_mesDown      , mpp_dy_v2

s1b1jresolvedMcut_jesUp_Tot    = baseline_jesUp_Tot    , btagM , isBoosted != 1  , ellypsMassCut_jesUp_Tot  , noVBFloose_jesUp_Tot
s1b1jresolvedMcut_jesDown_Tot  = baseline_jesDown_Tot  , btagM , isBoosted != 1  , ellypsMassCut_jesDown_Tot, noVBFloose_jesDown_Tot
s2b0jresolvedMcut_jesUp_Tot    = baseline_jesUp_Tot    , btagMM, isBoosted != 1  , ellypsMassCut_jesUp_Tot  , noVBFloose_jesUp_Tot
s2b0jresolvedMcut_jesDown_Tot  = baseline_jesDown_Tot  , btagMM, isBoosted != 1  , ellypsMassCut_jesDown_Tot, noVBFloose_jesDown_Tot
sboostedLLMcut_jesUp_Tot       = baseline_jesUp_Tot    , btagLL, isBoosted == 1  , boostMassCut_jesUp_Tot   , noVBFloose_jesUp_Tot
sboostedLLMcut_jesDown_Tot     = baseline_jesDown_Tot  , btagLL, isBoosted == 1  , boostMassCut_jesDown_Tot , noVBFloose_jesDown_Tot
VBFloose_jesUp_Tot             = baseline_jesUp_Tot    , jetsVBFloose_jesUp_Tot  , tauH_SVFIT_mass_jetupTot   > 50, btagMfirst
VBFloose_jesDown_Tot           = baseline_jesDown_Tot  , jetsVBFloose_jesDown_Tot, tauH_SVFIT_mass_jetdownTot > 50, btagMfirst
GGFclass_jesUp_Tot             = VBFloose_jesUp_Tot    , mpp_ggf_v2
GGFclass_jesDown_Tot           = VBFloose_jesDown_Tot  , mpp_ggf_v2
VBFclass_jesUp_Tot             = VBFloose_jesUp_Tot    , mpp_vbf_v2
VBFclass_jesDown_Tot           = VBFloose_jesDown_Tot  , mpp_vbf_v2
ttHclass_jesUp_Tot             = VBFloose_jesUp_Tot    , mpp_tth_v2
ttHclass_jesDown_Tot           = VBFloose_jesDown_Tot  , mpp_tth_v2
TTlepclass_jesUp_Tot           = VBFloose_jesUp_Tot    , mpp_ttlep_v2
TTlepclass_jesDown_Tot         = VBFloose_jesDown_Tot  , mpp_ttlep_v2
TThadclass_jesUp_Tot           = VBFloose_jesUp_Tot    , mpp_tthad_v2
TThadclass_jesDown_Tot         = VBFloose_jesDown_Tot  , mpp_tthad_v2
DYclass_jesUp_Tot              = VBFloose_jesUp_Tot    , mpp_dy_v2
DYclass_jesDown_Tot            = VBFloose_jesDown_Tot  , mpp_dy_v2

#########################################################################
#########################################################################

## weights to be applied for a certain selections when calling Fill()
## multiple weights are passed as list and are multiplied together
## NOTE: no weight is applied for data (the simple Fill() is used)
[selectionWeights]
baseline  = MC_weight, PUReweight, PUjetID_SF, L1pref_weight, prescaleWeight, trigSF, IdAndIsoAndFakeSF_deep_pt, DYscale_MTT

# remove DY weights, they are already taken into account in baseline weights
btagLL    = bTagweightL
btagMM    = bTagweightM
nobtagMM  = bTagweightM
btagL     = bTagweightL
btagM     = bTagweightM
btagMfirst = bTagweightM

#########################################################################
#########################################################################

[sampleWeights]

#########################################################################
#########################################################################

# define alternative weights to be tested instead of the nominal one
[systematics]
#TTtopPtreweight  = topUp:TTtopPtreweight_up , topDown:TTtopPtreweight_down
# trigSF         = trigUP:trigSF_up , trigDOWN:trigSF_down
# turnOnreweight = rewUP:turnOnreweight_tauup, rewDO:turnOnreweight_taudown

#########################################################################
#########################################################################

# ROOT-like definition of the binning
[histos]
DNNoutSM_kl_1            = 35,0,1

#########################################################################
#########################################################################

# user defined binning for a variable - has precedence on [histos]
[binning]
mdnn__v2__kl1_c2v1_c31__hh_ggf  = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958
mdnn__v2__kl1_c2v1_c31__hh_vbf  = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958
mdnn__v2__kl1_c2v1_c31__tth     = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958
mdnn__v2__kl1_c2v1_c31__tt_lep  = 0.16, 0.3862, 0.4405, 0.4825, 0.519, 0.5482, 0.5774, 0.6028, 0.6282, 0.6536, 0.6789, 0.7042, 0.7295, 0.7548, 0.7801, 0.8054, 0.8307, 0.856, 0.8813, 0.9066, 1.0
mdnn__v2__kl1_c2v1_c31__tt_fh   = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958
mdnn__v2__kl1_c2v1_c31__dy      = 0.16, 0.202, 0.244, 0.286, 0.328, 0.37, 0.412, 0.454, 0.496, 0.538, 0.58, 0.622, 0.664, 0.706, 0.748, 0.79, 0.832, 0.874, 0.916, 0.958

#########################################################################
#########################################################################

[histos2D]

[binning2D]


