#include <TFile.h>
#include <TTree.h>


#include <iostream>
#include <fstream>
#include <iomanip>

void selections_tautau(){
  TFile *file = TFile::Open("output.root");
  TTree *tree = (TTree *) file->Get("HTauTauTree");
  
  /////////TauTau
  TCut resolved_2b0j = "isOS == 1 && pairType == 2 && dau1_pt > 45 && abs(dau1_eta) < 2.1 && dau2_pt > 45 && abs(dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID > 0.460 && isBoosted != 1 && bTagweightL > -999"; 
  TCut resolved_1b1j = "isOS == 1 && pairType == 2 && dau1_pt > 45 && abs(dau1_eta) < 2.1 && dau2_pt > 45 && abs(dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID < 0.460 && isBoosted != 1" ;
  TCut resolved_2b0j_Mcut = "isOS == 1 && pairType == 2 && dau1_pt > 45 && abs(dau1_eta) < 2.1 && dau2_pt > 45 && abs(dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID > 0.460 && isBoosted != 1 && tauH_SVFIT_mass > 80 && tauH_SVFIT_mass < 160 && bH_mass_raw > 80 && bH_mass_raw < 160 && bTagweightL > -999" ;
  TCut resolved_1b1j_Mcut =" isOS == 1 && pairType == 2 && dau1_pt > 45 && abs(dau1_eta) < 2.1 && dau2_pt > 45 && abs(dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID < 0.460 && isBoosted != 1 && tauH_SVFIT_mass > 80 && tauH_SVFIT_mass < 160 && bH_mass_raw > 80 && bH_mass_raw < 160"; 
  
  TCut resolved_2b0j_McutCirc =" isOS == 1 && pairType == 2 && dau1_pt > 45 && abs(dau1_eta) < 2.1 && dau2_pt > 45 && abs(dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID > 0.460 && isBoosted != 1 && TMath::Sqrt((tauH_SVFIT_mass-111)*(tauH_SVFIT_mass-111) + (bH_mass_raw-120)*(bH_mass_raw-120)) < 35 && bTagweightL > -999 ";
  TCut resolved_1b1j_McutCirc =" isOS == 1 && pairType == 2 && dau1_pt > 45 && abs(dau1_eta) < 2.1 && dau2_pt > 45 && abs(dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID < 0.460 && isBoosted != 1 && TMath::Sqrt((tauH_SVFIT_mass-111)*(tauH_SVFIT_mass-111) + (bH_mass_raw-120)*(bH_mass_raw-120)) < 35 ";
  
  
  TCut boosted = "isOS == 1 && pairType == 2 && dau1_pt > 45 && abs(dau1_eta) < 2.1 && dau2_pt > 45 && abs(dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID > 0.460 && isBoosted == 1"; 
  TCut boosted_Mcut  =" isOS == 1 && pairType == 2 && dau1_pt > 45 && abs(dau1_eta) < 2.1 && dau2_pt > 45 && abs(dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID > 0.460 && isBoosted == 1 && tauH_SVFIT_mass > 80 && tauH_SVFIT_mass < 160 && fatjet_softdropMass > 90 && fatjet_softdropMass < 160"; 
  
  TCut defaultBtagLLNoIsoBBTTCut450tag = "isOS == 1 && pairType == 2 && dau1_pt > 45 && abs (dau1_eta) < 2.1 && dau2_pt > 45 && abs (dau2_eta) < 2.1 && nleps == 0 && bjet1_bID < 0.460 && bjet2_bID < 0.460 && bH_mass_raw > 80 && bH_mass_raw < 160 && tauH_SVFIT_mass > 80 && tauH_SVFIT_mass < 160 && HH_mass_raw > 200 && bTagweightL > -999";
  TCut defaultBtagLLNoIsoBBTTCut451tag =" isOS == 1 && pairType == 2 && dau1_pt > 45 && abs (dau1_eta) < 2.1 && dau2_pt > 45 && abs (dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID < 0.460 && bH_mass_raw > 80 && bH_mass_raw < 160 && tauH_SVFIT_mass > 80 && tauH_SVFIT_mass < 160 && HH_mass_raw > 200 && bTagweightL > -999";
  TCut defaultBtagLLNoIsoBBTTCut45 = "isOS == 1 && pairType == 2 && dau1_pt > 45 && abs (dau1_eta) < 2.1 && dau2_pt > 45 && abs (dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID > 0.460 && bH_mass_raw > 80 && bH_mass_raw < 160 && tauH_SVFIT_mass > 80 && tauH_SVFIT_mass < 160 && HH_mass_raw > 200 && bTagweightL > -999";
  TCut defaultBtagLLNoIso45 =" isOS == 1 && pairType == 2 && dau1_pt > 45 && abs (dau1_eta) < 2.1 && dau2_pt > 45 && abs (dau2_eta) < 2.1 && nleps == 0 && bjet1_bID > 0.460 && bjet2_bID > 0.460 && HH_mass_raw > 200 && bTagweightL > -999";
  
  
  ((TTreePlayer*)(tree->GetPlayer()))->SetScanRedirect(true);
  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("resolved_2b0j_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",resolved_2b0j);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("resolved_1b1j_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",resolved_1b1j);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("resolved_2b0j_Mcut_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",resolved_2b0j_Mcut);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("resolved_1b1j_Mcut_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",resolved_1b1j_Mcut);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("resolved_2b0j_McutCirc_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",resolved_2b0j_McutCirc);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("resolved_1b1j_McutCirc_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",resolved_1b1j_McutCirc);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("boosted_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",boosted);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("boosted_Mcut_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",boosted_Mcut);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("defaultBtagLLNoIsoBBTTCut450tag_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",defaultBtagLLNoIsoBBTTCut450tag);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("defaultBtagLLNoIsoBBTTCut451tag_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",defaultBtagLLNoIsoBBTTCut451tag);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("defaultBtagLLNoIsoBBTTCut45_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",defaultBtagLLNoIsoBBTTCut45);

  ((TTreePlayer*)(tree->GetPlayer()))->SetScanFileName("defaultBtagLLNoIso45_tautau.txt");
  tree->Scan("EventNumber:RunNumber:lumi",defaultBtagLLNoIso45);
}
